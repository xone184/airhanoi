import{c as T,r as d,j as e}from"./index-By5jZMuW.js";import{M as C}from"./map-pin-B0heecFp.js";import{A as B}from"./alert-circle-Be4LsZEN.js";import{R as g,X as p,Y as b,C as j,T as f,B as M,L as I,a as D}from"./generateCategoricalChart-D3fciRob.js";import{A as Q}from"./AreaChart-DWyxTlPR.js";import{A as S}from"./Area-Dq7aMrxc.js";import{B as L}from"./BarChart-fFDBR4hP.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=T("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),P=({realtimeData:K,forecastData:a})=>{const[l,N]=d.useState("all"),m=d.useMemo(()=>!a||a.length===0?[]:[...new Set(a.map(r=>r.district))].filter(Boolean).sort(),[a]),c=d.useMemo(()=>!a||a.length===0?[]:l==="all"?a:a.filter(t=>t.district===l),[a,l]),i=d.useMemo(()=>{if(c.length===0)return[];const t={};return c.forEach(s=>{const n=s.datetime.split(" ")[0]||s.datetime;t[n]||(t[n]={totalAqi:0,count:0,date:n}),t[n].totalAqi+=s.aqi_forecast,t[n].count+=1}),Object.values(t).map(s=>({name:s.date,aqi:Math.round(s.totalAqi/s.count)})).sort((s,n)=>new Date(s.name).getTime()-new Date(n.name).getTime()).slice(0,7)},[c]),h=d.useMemo(()=>{if(!a||a.length===0||l!=="all")return[];const t={};return a.forEach(r=>{r.district&&(t[r.district]||(t[r.district]={totalAqi:0,count:0}),t[r.district].totalAqi+=r.aqi_forecast,t[r.district].count+=1)}),Object.entries(t).map(([r,s])=>({district:r,aqi:Math.round(s.totalAqi/s.count)})).sort((r,s)=>s.aqi-r.aqi)},[a,l]),v=t=>t<=50?"#22c55e":t<=100?"#eab308":t<=150?"#f97316":t<=200?"#ef4444":t<=300?"#a855f7":"#9f1239",u=a.length>0,w=l==="all"?"Xu H∆∞·ªõng AQI Trung B√¨nh To√†n H√† N·ªôi (5 Ng√†y T·ªõi)":`Xu H∆∞·ªõng AQI D·ª± B√°o ‚Äì ${l} (5 Ng√†y T·ªõi)`,y=l==="all"?"H√† N·ªôi":l;return e.jsxs("div",{className:"p-4 lg:p-6 animate-fade-in h-full overflow-y-auto",children:[e.jsxs("header",{className:"mb-4 flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Ph√¢n T√≠ch & D·ª± B√°o"}),e.jsx("p",{className:"text-slate-400",children:"D·ªØ li·ªáu t·ª´ m√¥ h√¨nh AI (Open-Meteo & Tomorrow.io)"})]}),u&&e.jsx("div",{className:"relative shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2 bg-slate-800 border border-slate-600 rounded-xl px-3 py-2.5 hover:border-blue-500 transition-colors focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500/30",children:[e.jsx(C,{size:16,className:"text-blue-400 shrink-0"}),e.jsxs("select",{value:l,onChange:t=>N(t.target.value),className:"bg-transparent text-white text-sm font-medium appearance-none outline-none cursor-pointer pr-6 min-w-[160px]",children:[e.jsx("option",{value:"all",className:"bg-slate-800",children:"To√†n th√†nh ph·ªë"}),m.map(t=>e.jsx("option",{value:t,className:"bg-slate-800",children:t},t))]}),e.jsx(H,{size:14,className:"text-slate-400 absolute right-3 pointer-events-none"})]})})]}),u?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-4 border border-slate-700 shadow-xl mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:w}),e.jsx("div",{className:"h-80 w-full",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(Q,{data:i,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorAqi",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8b5cf6",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#8b5cf6",stopOpacity:0})]})}),e.jsx(p,{dataKey:"name",stroke:"#94a3b8",tickFormatter:t=>new Date(t).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit"})}),e.jsx(b,{stroke:"#94a3b8"}),e.jsx(j,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(f,{contentStyle:{backgroundColor:"#1e293b",borderColor:"#334155",color:"#f8fafc"},labelFormatter:t=>new Date(t).toLocaleDateString("vi-VN")}),e.jsx(S,{type:"monotone",dataKey:"aqi",stroke:"#8b5cf6",fillOpacity:1,fill:"url(#colorAqi)",name:"AQI D·ª± b√°o"})]})})})]}),l==="all"&&h.length>0&&e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-4 border border-slate-700 shadow-xl mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"So S√°nh AQI D·ª± B√°o Theo Qu·∫≠n/Huy·ªán"}),e.jsx("div",{style:{height:Math.max(300,h.length*32)},className:"w-full",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(L,{data:h,layout:"vertical",margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(j,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(p,{type:"number",stroke:"#94a3b8"}),e.jsx(b,{dataKey:"district",type:"category",stroke:"#94a3b8",width:120,tick:{fontSize:11}}),e.jsx(f,{contentStyle:{backgroundColor:"#1e293b",borderColor:"#334155",color:"#f8fafc"},formatter:t=>[`AQI: ${t}`,"D·ª± b√°o TB"]}),e.jsxs(M,{dataKey:"aqi",name:"AQI TB",radius:[0,6,6,0],barSize:18,children:[e.jsx(I,{dataKey:"aqi",position:"right",fill:"#e2e8f0",fontSize:11,fontWeight:600}),h.map((t,r)=>e.jsx(D,{fill:v(t.aqi)},`cell-${r}`))]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-900 to-slate-900 p-4 rounded-2xl border border-blue-800 shadow-lg",children:[e.jsx("h4",{className:"text-blue-300 font-bold mb-2 uppercase text-xs tracking-wider",children:"D·ªØ Li·ªáu D·ª± B√°o"}),e.jsx("div",{className:"text-4xl font-black text-white",children:c.length}),e.jsx("p",{className:"text-xs text-blue-400 mt-2 font-medium",children:l==="all"?"B·∫£n ghi t·ª´ m√¥ h√¨nh AI":`B·∫£n ghi cho ${l}`})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-900 to-slate-900 p-4 rounded-2xl border border-purple-800 shadow-lg",children:[e.jsx("h4",{className:"text-purple-300 font-bold mb-2 uppercase text-xs tracking-wider",children:"Xu H∆∞·ªõng Chung"}),e.jsx("div",{className:"text-4xl font-black text-white",children:i.length>0&&i[i.length-1].aqi>i[0].aqi?"TƒÉng":"Gi·∫£m"}),e.jsx("p",{className:"text-xs text-purple-400 mt-2 font-medium",children:"So v·ªõi ng√†y hi·ªán t·∫°i"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-emerald-900 to-slate-900 p-4 rounded-2xl border border-emerald-800 shadow-lg",children:[e.jsx("h4",{className:"text-emerald-300 font-bold mb-2 uppercase text-xs tracking-wider",children:"Khu V·ª±c"}),e.jsx("div",{className:"text-xl font-bold text-white",children:l==="all"?"To√†n TP":l}),e.jsxs("p",{className:"text-xs text-emerald-400 mt-2 font-medium",children:[m.length," qu·∫≠n/huy·ªán c√≥ d·ªØ li·ªáu"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-slate-900 to-slate-800 rounded-3xl p-1 p-[1px] shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 opacity-20 group-hover:opacity-30 transition-opacity duration-500"}),e.jsxs("div",{className:"relative bg-slate-900/95 backdrop-blur-xl rounded-[23px] p-4 lg:p-6 h-full",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl shadow-lg shadow-cyan-500/20",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white",children:[e.jsx("path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5 10 10 0 0 0-4 4 4 4 0 0 1-5-5"}),e.jsx("path",{d:"M8.5 8.5v.01"}),e.jsx("path",{d:"M16 15.5v.01"}),e.jsx("path",{d:"M12 12v.01"}),e.jsx("path",{d:"M7 17v.01"}),e.jsx("path",{d:"M17 7v.01"})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-400",children:"Ph√¢n T√≠ch & D·ª± B√°o T·ª´ AI"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"H·ªá th·ªëng t·ª± ƒë·ªông ph√¢n t√≠ch d·ªØ li·ªáu v√† ƒë∆∞a ra nh·∫≠n ƒë·ªãnh"})]})]}),(()=>{if(i.length===0)return null;const t=i[0].aqi,r=i.slice(1),s=r.reduce((o,q)=>o+q.aqi,0)/(r.length||1),n=Math.max(...r.map(o=>o.aqi)),x=r.find(o=>o.aqi===n),k=s>t?"x·∫•u ƒëi":"c·∫£i thi·ªán",A=s>t?"text-red-400":"text-emerald-400";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-2xl p-4 border border-slate-700/50",children:[e.jsxs("h4",{className:"text-slate-300 font-bold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-400"}),"Nh·∫≠n ƒë·ªãnh xu h∆∞·ªõng"]}),e.jsxs("p",{className:"text-slate-300 leading-relaxed text-sm",children:["D·ª±a tr√™n m√¥ h√¨nh d·ª± b√°o, ch·∫•t l∆∞·ª£ng kh√¥ng kh√≠ t·∫°i ",e.jsx("span",{className:"font-bold text-white",children:y})," c√≥ xu h∆∞·ªõng ",e.jsx("span",{className:`font-bold ${A}`,children:k})," trong 5 ng√†y t·ªõi. AQI trung b√¨nh d·ª± ki·∫øn kho·∫£ng ",e.jsx("span",{className:"font-bold text-white",children:Math.round(s)}),"."]})]}),x&&e.jsxs("div",{className:"bg-slate-800/50 rounded-2xl p-4 border border-slate-700/50",children:[e.jsxs("h4",{className:"text-slate-300 font-bold mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-orange-400"}),"C·∫£nh b√°o cao ƒëi·ªÉm"]}),e.jsxs("p",{className:"text-slate-300 leading-relaxed text-sm",children:["D·ª± b√°o ng√†y ",e.jsx("span",{className:"font-bold text-white",children:new Date(x.name).toLocaleDateString("vi-VN")})," s·∫Ω l√† th·ªùi ƒëi·ªÉm √¥ nhi·ªÖm nh·∫•t ",l!=="all"?`t·∫°i ${l}`:"trong chu k·ª≥"," v·ªõi AQI c√≥ th·ªÉ ƒë·∫°t ng∆∞·ª°ng ",e.jsx("span",{className:"font-bold text-orange-400",children:x.aqi}),"."]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-slate-300 font-bold mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-400"}),"Khuy·∫øn ngh·ªã h√†nh ƒë·ªông"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/30 p-4 rounded-xl border border-slate-700/30 hover:border-slate-600 transition-colors",children:[e.jsx("div",{className:"text-2xl mb-2",children:"üò∑"}),e.jsx("p",{className:"text-xs text-slate-400 font-semibold uppercase mb-1",children:"S·ª©c kh·ªèe"}),e.jsx("p",{className:"text-sm text-slate-200",children:s>150?"B·∫Øt bu·ªôc ƒëeo kh·∫©u trang ch·ªëng b·ª•i m·ªãn khi ra ƒë∆∞·ªùng.":"N√™n mang theo kh·∫©u trang ph√≤ng ng·ª´a b·ª•i."})]}),e.jsxs("div",{className:"bg-slate-800/30 p-4 rounded-xl border border-slate-700/30 hover:border-slate-600 transition-colors",children:[e.jsx("div",{className:"text-2xl mb-2",children:"üèÉ"}),e.jsx("p",{className:"text-xs text-slate-400 font-semibold uppercase mb-1",children:"V·∫≠n ƒë·ªông"}),e.jsx("p",{className:"text-sm text-slate-200",children:s>150?"H·∫°n ch·∫ø t·ªëi ƒëa c√°c ho·∫°t ƒë·ªông th·ªÉ thao ngo√†i tr·ªùi.":"C√≥ th·ªÉ t·∫≠p th·ªÉ d·ª•c nh·∫π nh√†ng v√†o s√°ng s·ªõm."})]}),e.jsxs("div",{className:"bg-slate-800/30 p-4 rounded-xl border border-slate-700/30 hover:border-slate-600 transition-colors",children:[e.jsx("div",{className:"text-2xl mb-2",children:"üè†"}),e.jsx("p",{className:"text-xs text-slate-400 font-semibold uppercase mb-1",children:"T·∫°i nh√†"}),e.jsx("p",{className:"text-sm text-slate-200",children:s>100?"N√™n ƒë√≥ng k√≠n c·ª≠a s·ªï v√† s·ª≠ d·ª•ng m√°y l·ªçc kh√¥ng kh√≠.":"Th∆∞·ªùng xuy√™n v·ªá sinh nh√† c·ª≠a, m·ªü c·ª≠a khi AQI th·∫•p."})]})]})]})]})})()]})]})]}):e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-8 border border-slate-700 text-center flex flex-col items-center justify-center min-h-[400px]",children:[e.jsx(B,{size:48,className:"text-orange-500 mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Ch∆∞a c√≥ d·ªØ li·ªáu d·ª± b√°o"}),e.jsxs("p",{className:"text-slate-400 max-w-md",children:["Vui l√≤ng truy c·∫≠p trang ",e.jsx("b",{children:"Qu·∫£n Tr·ªã H·ªá Th·ªëng"})," (d√†nh cho Admin) v√† t·∫£i l√™n file ",e.jsx("code",{children:"fact_forecast.csv"})," ƒë·ªÉ k√≠ch ho·∫°t t√≠nh nƒÉng n√†y."]})]})]})};export{P as default};
