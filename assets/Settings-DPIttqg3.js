import{c as p,r as o,j as e,M as y,H as z,d}from"./index-sY-2QvA3.js";import{C as m}from"./check-circle-BHfTJjBc.js";import{M as I}from"./map-pin-BiDJNJTV.js";import{A as k}from"./alert-triangle-C82Ci-el.js";import{S as K}from"./save-C_s3K0XG.js";import{G as S}from"./globe-DW9hyTeA.js";import{T as D}from"./thermometer-B7KeXHk1.js";import{S as T}from"./sun-pd3hD7C3.js";import{I as H}from"./info-CnoVUQWi.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=p("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=p("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=p("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),W=({onSettingsUpdated:i})=>{const[t,h]=o.useState({email:"",phone:"",alertDistrict:"Ba Đình",alertThreshold:150,enableEmailAlerts:!0,enableSmsAlerts:!1,language:"vi",temperatureUnit:"c",themeMode:"dark"}),[j,b]=o.useState(!1),[c,f]=o.useState({}),[g,A]=o.useState(!0),[N,v]=o.useState(null),[u,w]=o.useState(null);o.useEffect(()=>{(async()=>{try{const l=await d.getSettings();l&&h(l),v(null)}catch(l){console.error("Failed to load settings:",l),v("Không thể tải cài đặt. Vui lòng đăng nhập và thử lại.")}finally{A(!1)}})()},[]);const a=async(s,l)=>{if(s==="language"){const r=l==="vi"?"Tiếng Việt":"English";if(!window.confirm(`Đổi ngôn ngữ sang ${r}?`))return;const n={...t,[s]:l};h(n),i&&i(n);try{await d.saveSettings(n)}catch(x){console.error("Auto-save settings failed:",x)}return}if(s==="temperatureUnit"){const r=l==="c"?"°C":"°F";if(!window.confirm(`Đổi đơn vị nhiệt độ sang ${r}?`))return;const n={...t,[s]:l};h(n),i&&i(n);try{await d.saveSettings(n)}catch(x){console.error("Auto-save settings failed:",x)}return}if(s==="themeMode"){const r=l==="light"?"Sáng":"Tối";if(!window.confirm(`Đổi sang chế độ giao diện ${r}?`))return;const n={...t,[s]:l};h(n),i&&i(n);try{await d.saveSettings(n)}catch(x){console.error("Auto-save settings failed:",x)}setTimeout(()=>{alert(`Đã chuyển sang chế độ ${r} thành công!`)},100);return}h(r=>({...r,[s]:l})),b(!1),(s==="email"||s==="phone")&&f(r=>({...r,[s]:void 0}))},E=()=>{const s={};let l=!0;return t.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)&&(s.email="Định dạng Email không hợp lệ.",l=!1),t.phone&&!/^(0|\+84)(3|5|7|8|9)[0-9]{8}$/.test(t.phone)&&(s.phone="SĐT không hợp lệ (VN: 10 số, đầu 03/05/07/08/09).",l=!1),f(s),l},M=async s=>{if(s.preventDefault(),!!E()){w(null);try{await d.saveSettings(t),i&&i(t),b(!0),setTimeout(()=>b(!1),3e3),alert("Đã lưu cài đặt thành công.")}catch(l){console.error("Failed to save settings:",l),w((l==null?void 0:l.message)||"Không thể lưu cài đặt. Vui lòng thử lại.")}}},$=async()=>{if(!t.email){alert("Vui lòng nhập Email trước khi gửi thử.");return}if(window.confirm(`Gửi email thử tới ${t.email}?`))try{await d.sendTestEmail({email:t.email,subject:"AirHanoi - Email thử nghiệm",message:"Đây là email thử nghiệm từ AirHanoi. Nếu bạn nhận được, hệ thống gửi mail đã hoạt động."}),alert("Đã gửi email thử. Vui lòng kiểm tra hộp thư (và spam).")}catch(s){console.error("Test email error:",s),alert((s==null?void 0:s.message)||"Không thể gửi email thử. Kiểm tra cấu hình SMTP.")}};return e.jsxs("div",{className:"p-6 lg:p-10 animate-fade-in h-full overflow-y-auto pb-20",children:[e.jsxs("header",{className:"mb-8 border-b border-slate-800 pb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Cài Đặt & Cảnh Báo"}),e.jsx("p",{className:"text-slate-400",children:"Đăng ký nhận tin cảnh báo ô nhiễm và cấu hình hệ thống"}),N&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:N}),g&&e.jsx("p",{className:"text-slate-400 text-sm mt-2",children:"Đang tải cài đặt..."}),j&&!u&&e.jsxs("p",{className:"text-emerald-400 text-sm mt-2 flex items-center gap-2",children:[e.jsx(m,{size:14})," Đã lưu cài đặt thành công"]}),u&&e.jsx("p",{className:"text-red-400 text-sm mt-2",children:u})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("form",{onSubmit:M,className:"bg-slate-800 rounded-2xl p-6 lg:p-8 border border-slate-700 shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-500/10 rounded-bl-full -mr-10 -mt-10 pointer-events-none"}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-600/20 text-blue-400 rounded-xl",children:e.jsx(V,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Đăng Ký Cảnh Báo Tự Động"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Nhận thông báo khi chất lượng không khí vượt ngưỡng an toàn"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Email nhận tin"}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-3 text-slate-500",size:18}),e.jsx("input",{type:"email",className:`w-full bg-slate-900 border ${c.email?"border-red-500":"border-slate-700"} rounded-lg py-2.5 pl-10 pr-4 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all`,placeholder:"example@email.com",value:t.email,onChange:s=>a("email",s.target.value)})]}),c.email&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:c.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Số điện thoại (SMS)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-3 text-slate-500",size:18}),e.jsx("input",{type:"tel",className:`w-full bg-slate-900 border ${c.phone?"border-red-500":"border-slate-700"} rounded-lg py-2.5 pl-10 pr-4 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-all`,placeholder:"+84 912 345 678",value:t.phone,onChange:s=>a("phone",s.target.value)})]}),c.phone&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:c.phone})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Khu vực theo dõi chính"}),e.jsxs("div",{className:"relative",children:[e.jsx(I,{className:"absolute left-3 top-3 text-slate-500",size:18}),e.jsx("select",{className:"w-full bg-slate-900 border border-slate-700 rounded-lg py-2.5 pl-10 pr-4 text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none appearance-none cursor-pointer",value:t.alertDistrict,onChange:s=>a("alertDistrict",s.target.value),children:z.map(s=>e.jsx("option",{value:s.name,children:s.name},s.name))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Gửi email khi AQI đạt mức:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>a("alertThreshold",100),className:`p-3 rounded-lg border-2 text-left transition-all ${t.alertThreshold===100?"border-yellow-500 bg-yellow-500/20":"border-slate-700 bg-slate-900 hover:border-yellow-500/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("span",{className:"font-bold text-white",children:"AQI ≥ 100"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Trung bình - Cảnh báo sớm"})]}),e.jsxs("button",{type:"button",onClick:()=>a("alertThreshold",150),className:`p-3 rounded-lg border-2 text-left transition-all ${t.alertThreshold===150?"border-orange-500 bg-orange-500/20":"border-slate-700 bg-slate-900 hover:border-orange-500/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"}),e.jsx("span",{className:"font-bold text-white",children:"AQI ≥ 150"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Kém - Ảnh hưởng người nhạy cảm"})]}),e.jsxs("button",{type:"button",onClick:()=>a("alertThreshold",200),className:`p-3 rounded-lg border-2 text-left transition-all ${t.alertThreshold===200?"border-red-500 bg-red-500/20":"border-slate-700 bg-slate-900 hover:border-red-500/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{className:"font-bold text-white",children:"AQI ≥ 200"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Xấu - Hạn chế ra ngoài"})]}),e.jsxs("button",{type:"button",onClick:()=>a("alertThreshold",300),className:`p-3 rounded-lg border-2 text-left transition-all ${t.alertThreshold===300?"border-purple-500 bg-purple-500/20":"border-slate-700 bg-slate-900 hover:border-purple-500/50"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),e.jsx("span",{className:"font-bold text-white",children:"AQI ≥ 300"})]}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Nguy hại - Chỉ cảnh báo khẩn cấp"})]})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2 flex items-center gap-1",children:[e.jsx(k,{size:12}),"Email sẽ được gửi tự động khi AQI tại ",t.alertDistrict," vượt ngưỡng này"]})]})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-700/50 mb-6",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-300 mb-3 uppercase tracking-wider",children:"Kênh thông báo"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[e.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${t.enableEmailAlerts?"bg-blue-500 border-blue-500":"border-slate-500"}`,children:t.enableEmailAlerts&&e.jsx(m,{size:14,className:"text-white text-invariant-white"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:t.enableEmailAlerts,onChange:s=>a("enableEmailAlerts",s.target.checked)}),e.jsx("span",{className:"text-slate-300 group-hover:text-white transition-colors",children:"Email"})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group opacity-50",title:"Tính năng SMS đang phát triển",children:[e.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${t.enableSmsAlerts?"bg-blue-500 border-blue-500":"border-slate-500"}`,children:t.enableSmsAlerts&&e.jsx(m,{size:14,className:"text-white text-invariant-white"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:t.enableSmsAlerts,onChange:s=>a("enableSmsAlerts",s.target.checked),disabled:!0}),e.jsx("span",{className:"text-slate-300",children:"SMS (sắp có)"})]})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-3",children:e.jsxs("button",{type:"button",onClick:$,className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white text-invariant-white text-sm font-bold rounded-lg transition-colors flex items-center gap-2",children:[e.jsx(y,{size:16}),"Gửi email thử"]})}),e.jsx("div",{className:"mt-4 p-3 bg-emerald-500/10 border border-emerald-500/30 rounded-lg",children:e.jsxs("p",{className:"text-xs text-emerald-300 flex items-start gap-2",children:[e.jsx(m,{size:14,className:"flex-shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Cách hoạt động:"})," Khi AQI tại ",t.alertDistrict," đạt mức ",t.alertThreshold," trở lên, hệ thống sẽ tự động gửi email cảnh báo đến ",t.email||"email của bạn"," kèm theo khuyến nghị sức khỏe."]})]})})]}),e.jsxs("button",{type:"submit",disabled:g,className:`w-full py-3 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-500 hover:to-cyan-500 text-white text-invariant-white font-bold rounded-xl shadow-lg shadow-blue-900/50 transition-all active:scale-[0.98] flex items-center justify-center gap-2 ${g?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(K,{size:20}),g?"Đang tải...":j?"Đã Lưu Thành Công!":"Lưu Đăng Ký"]})]})}),e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 border border-slate-700 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-600/20 text-purple-400 rounded-lg",children:e.jsx(S,{size:20})}),e.jsx("h2",{className:"text-lg font-bold text-white",children:"Tùy Chỉnh Ứng Dụng"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-900/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{size:18,className:"text-slate-400"}),e.jsx("span",{className:"text-slate-200",children:"Ngôn ngữ"})]}),e.jsxs("div",{className:"flex bg-slate-800 p-1 rounded-lg border border-slate-700",children:[e.jsx("button",{onClick:()=>a("language","vi"),className:`px-3 py-1 rounded text-xs font-medium transition-all ${t.language==="vi"?"bg-purple-600 text-white text-invariant-white shadow":"text-slate-400 hover:text-white"}`,children:"Tiếng Việt"}),e.jsx("button",{onClick:()=>a("language","en"),className:`px-3 py-1 rounded text-xs font-medium transition-all ${t.language==="en"?"bg-purple-600 text-white text-invariant-white shadow":"text-slate-400 hover:text-white"}`,children:"English"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-900/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{size:18,className:"text-slate-400"}),e.jsx("span",{className:"text-slate-200",children:"Đơn vị nhiệt độ"})]}),e.jsxs("div",{className:"flex bg-slate-800 p-1 rounded-lg border border-slate-700",children:[e.jsx("button",{onClick:()=>a("temperatureUnit","c"),className:`px-3 py-1 rounded text-xs font-medium transition-all ${t.temperatureUnit==="c"?"bg-orange-600 text-white text-invariant-white shadow":"text-slate-400 hover:text-white"}`,children:"°C"}),e.jsx("button",{onClick:()=>a("temperatureUnit","f"),className:`px-3 py-1 rounded text-xs font-medium transition-all ${t.temperatureUnit==="f"?"bg-orange-600 text-white text-invariant-white shadow":"text-slate-400 hover:text-white"}`,children:"°F"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-900/50 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.themeMode==="dark"?e.jsx(C,{size:18,className:"text-slate-400"}):e.jsx(T,{size:18,className:"text-yellow-400"}),e.jsx("span",{className:"text-slate-200",children:"Chế độ giao diện"})]}),e.jsxs("div",{className:"flex bg-slate-800 p-1 rounded-lg border border-slate-700",children:[e.jsxs("button",{onClick:()=>a("themeMode","light"),className:`px-3 py-1 rounded text-xs font-medium transition-all flex items-center gap-1 ${t.themeMode==="light"?"bg-yellow-500 text-white text-invariant-white shadow":"text-slate-400 hover:text-white"}`,children:[e.jsx(T,{size:12})," Sáng"]}),e.jsxs("button",{onClick:()=>a("themeMode","dark"),className:`px-3 py-1 rounded text-xs font-medium transition-all flex items-center gap-1 ${t.themeMode==="dark"?"bg-indigo-600 text-white text-invariant-white shadow":"text-slate-400 hover:text-white"}`,children:[e.jsx(C,{size:12})," Tối"]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 border border-slate-700 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-emerald-600/20 text-emerald-400 rounded-lg",children:e.jsx(H,{size:20})}),e.jsx("h2",{className:"text-lg font-bold text-white",children:"Thông Tin Hệ Thống"})]}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between border-b border-slate-700/50 pb-3",children:[e.jsx("span",{className:"text-slate-400",children:"Phiên bản ứng dụng"}),e.jsx("span",{className:"text-white font-mono",children:"v1.3.0 (DB Connected)"})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-700/50 pb-3",children:[e.jsx("span",{className:"text-slate-400",children:"Nguồn dữ liệu"}),e.jsx("span",{className:"text-blue-400",children:"Open-Meteo & Tomorrow.io"})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-700/50 pb-3",children:[e.jsx("span",{className:"text-slate-400",children:"Trạng thái API"}),e.jsxs("span",{className:"text-emerald-400 flex items-center gap-1",children:[e.jsx(m,{size:12})," Hoạt động"]})]}),e.jsxs("div",{className:"flex justify-between pt-1",children:[e.jsx("span",{className:"text-slate-400",children:"Hỗ trợ kỹ thuật"}),e.jsx("span",{className:"text-slate-200",children:"support@airhanoi.vn"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-500/10 border border-blue-500/20 rounded-xl flex items-start gap-3",children:[e.jsx(k,{className:"text-blue-300 flex-shrink-0 mt-0.5",size:16}),e.jsx("p",{className:"text-xs text-blue-100/80 leading-relaxed",children:"Mọi thắc mắc vui lòng liên hệ: adairhanoi@gmail.com để được giải quyết"})]})]})]})]})};export{W as default};
